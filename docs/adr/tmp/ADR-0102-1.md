ADR-0102: E27 Key Lifetimes and session_id Semantics

Status: Accepted

Context
The E27 protocol uses multiple keys with distinct lifetimes. Misinterpreting
these lifetimes risks authentication failure, replay errors, or unintended
re-linking.

Decision
Key and session semantics are defined as follows:

1. Link Key / Link HMAC
   - Established via api_link
   - Long-lived
   - Represents application-to-panel association
   - Equivalent to "wiring" a keypad to the panel
   - Survives TCP disconnects and restarts

2. Session Key / Session HMAC
   - Established via hello
   - Short-lived
   - Valid only for the duration of a single TCP connection
   - MUST be renegotiated on reconnect

3. session_id
   - Issued during hello
   - Identifies the active session
   - Included in subsequent authenticated messages
   - Invalidated on disconnect

4. Failure Semantics
   - Incorrect link credentials may result in silent failure
     (no response from panel)
   - Session code must detect timeout and escalate accordingly

Consequences
- api_link is a provisioning operation, not a connection operation.
- hello is mandatory for every TCP session.
- Session state must be treated as ephemeral.
